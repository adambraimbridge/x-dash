{"componentChunkName":"component---src-templates-documentation-page-jsx","path":"/docs/guides/migrating-to-x-teaser","result":{"data":{"markdown":{"html":"<h1 id=\"migrating-from-n-teaser-to-x-teaser\"><a href=\"#migrating-from-n-teaser-to-x-teaser\" aria-label=\"migrating from n teaser to x teaser permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Migrating from n-teaser to x-teaser</h1>\n<p>This component replaces the existing <code class=\"language-text\">@financial-times/n-teaser</code> package. The design decisions behind x-teaser are different to n-teaser and so the available options and data structures required are also different. However, great care has been taken to ensure that migrating an app to use x-teaser can be done quickly and in most cases you can end up with less code than before.</p>\n<h2 id=\"major-differences\"><a href=\"#major-differences\" aria-label=\"major differences permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Major differences</h2>\n<p>The n-teaser package provides a set of <a href=\"https://handlebarsjs.com/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Handlebars</a> templates for use by FT.com within the Handlebars setup provided by <a href=\"https://github.com/Financial-Times/n-ui\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">n-ui</a> and several <a href=\"https://graphql.org/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">GraphQL</a> fragments to fetch a range of data from <a href=\"https://github.com/Financial-Times/next-api\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Next API</a>. Presenter classes are loaded on application startup and called from inside the templates, provising the logic to select and format data. The n-teaser package contains 78kb of source code.</p>\n<p>The x-teaser package provides a single configurable component written in <a href=\"https://jasonformat.com/wtf-is-jsx/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">JSX</a> which may be rendered in The App or FT.com by any compatible runtime. The component expects the data it receives to be preformatted and therefore contains very little logic. The x-teaser package contains 18kb of source code.</p>\n<h2 id=\"guide\"><a href=\"#guide\" aria-label=\"guide permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Guide</h2>\n<h3 id=\"1-install-dependencies\"><a href=\"#1-install-dependencies\" aria-label=\"1 install dependencies permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Install dependencies</h3>\n<p>In addition to the x-teaser package you will also need to install the <a href=\"/x-dash/packages/x-handlebars\">x-handlebars</a> package which enables x-dash compatible components to be rendered inside your existing templates.</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\"><span class=\"token unchanged\">  \"dependencies\" {\n</span><span class=\"token deleted-sign deleted\">-     \"@financial-times/n-teaser\": \"^4.10.0\",\n</span><span class=\"token inserted-sign inserted\">+     \"@financial-times/x-handlebars\": \"^1.0.0\",\n+     \"@financial-times/x-teaser\": \"^1.0.0\",\n</span><span class=\"token unchanged\">  },</span></code></pre></div>\n<h3 id=\"2-install-and-configure-a-runtime\"><a href=\"#2-install-and-configure-a-runtime\" aria-label=\"2 install and configure a runtime permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Install and configure a runtime</h3>\n<p>There are a number of frameworks and libraries which can render components written with JSX. If you are already using a framework in your application then you should continue to use that where possible, otherwise it is recommend installing the <a href=\"https://www.npmjs.com/package/hyperons\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Hyperons</a> package which is small and very fast.</p>\n<p>The x-handlebars and x-teaser packages depend on a library called <a href=\"/x-dash/packages/x-engine\">x-engine</a>. This is a consolidation library that provides your chosen runtime to x-dash compatible components. The configuration for x-engine needs to be added to your package manifest now to instruct it how to load your runtime.</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\"><span class=\"token unchanged\">  \"dependencies\" {\n</span><span class=\"token inserted-sign inserted\">+     \"hyperons\": \"^0.4.0\",\n</span><span class=\"token unchanged\">  },\n</span><span class=\"token inserted-sign inserted\">+  \"x-dash\": {\n+    \"engine\": {\n+      \"server\": \"hyperons\"\n+    }\n+  }</span></code></pre></div>\n<h3 id=\"3-load-handlebars-helpers\"><a href=\"#3-load-handlebars-helpers\" aria-label=\"3 load handlebars helpers permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Load Handlebars helpers</h3>\n<p>User facing FT.com applications use an Express server provided by n-ui. As part of the server initialisation any Handlebars helpers can be loaded and made available to your templates.</p>\n<p>The n-teaser package uses this functionality to load its internal helper functions and the x-handlebars helpers are loaded in the same way.</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\"><span class=\"token unchanged\">  helpers: {\n</span><span class=\"token deleted-sign deleted\">-    nTeaserPresenter: require('@financial-times/n-teaser').presenter\n</span><span class=\"token inserted-sign inserted\">+    x: require('@financial-times/x-handlebars')()\n</span><span class=\"token unchanged\">  }</span></code></pre></div>\n<h3 id=\"4-fetching-the-right-data\"><a href=\"#4-fetching-the-right-data\" aria-label=\"4 fetching the right data permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. Fetching the right data</h3>\n<p>The data required to render teasers can now be fetched in a format ready for immediate use. Whether your application fetches its data from Next API (using GraphQL queries) or directly from <a href=\"https://github.com/Financial-Times/next-es-interface/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">Elasticsearch</a> the number of fields required and size of the payload to be transferred has been reduced dramatically.</p>\n<h4 id=\"changes-to-graphql-queries\"><a href=\"#changes-to-graphql-queries\" aria-label=\"changes to graphql queries permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Changes to GraphQL queries</h4>\n<p>With GraphQL every field and sub-field to be retrieved must be explicitly specified. For convenience the n-teaser package provides a range of GraphQL fragments to generate this list of fields for each teaser type.</p>\n<p>To avoid maintaining such a list the teaser data has been made available as a single JSON field named <code class=\"language-text\">teaser</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\"><span class=\"token deleted-sign deleted\">- const { fragments } = require('@financial-times/n-teaser');\n</span>\nmodule.exports = `\n<span class=\"token deleted-sign deleted\">-  ${fragments.teaserExtraLight}\n-  ${fragments.teaserLight}\n-  ${fragments.teaserStandard}\n-  ${fragments.teaserHeavy}\n-  ${fragments.teaserTopStory}\n</span><span class=\"token inserted-sign inserted\">+  teaser\n</span>`;</code></pre></div>\n<h4 id=\"changes-to-elasticsearch-queries\"><a href=\"#changes-to-elasticsearch-queries\" aria-label=\"changes to elasticsearch queries permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Changes to Elasticsearch queries</h4>\n<p>Wherever you specify a list, or include a list, of source fields to retrieve you may now replace this with a single entry of <code class=\"language-text\">teaser.*</code>.</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\">fields: [\n<span class=\"token deleted-sign deleted\">-   'id',\n-   'url',\n-   'relativeUrl',\n-   'type',\n-\n-   'title',\n-   'alternativeTitles.promotionalTitle',\n-   'alternativeTitles.promotionalTitleVariant',\n-\n-   'standfirst',\n-   'alternativeStandfirsts.promotionalStandfirst',\n-   'alternativeStandfirsts.promotionalStandfirstVariant',\n-\n-   'publishedDate',\n-   'firstPublishedDate',\n-\n-   'mainImage.*',\n-   'alternativeImages.promotionalImage.*',\n</span>\n<span class=\"token deleted-sign deleted\">-   'displayConcept.*',\n-   'brandConcept.*',\n-   'genreConcept.*',\n-   'authorConcepts.*',\n-\n</span><span class=\"token inserted-sign inserted\">+   'teaser.*'\n</span>];</code></pre></div>\n<h3 id=\"5-update-template-includes\"><a href=\"#5-update-template-includes\" aria-label=\"5 update template includes permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. Update template includes</h3>\n<p>The n-teaser package provides separate templates for each teaser layout. In contrast the x-handlebars package is generic and allows you to render any installed x-dash packages or local components in your Handlebars template.</p>\n<p>Teasers may be configured by providing attributes. Common use cases are provided via <a href=\"/x-dash/components/x-teaser#presets\">presets</a> and may be used by specifying the <code class=\"language-text\">preset</code> attribute.</p>\n<div class=\"gatsby-highlight\" data-language=\"diff\"><pre class=\"language-diff\"><code class=\"language-diff\"><span class=\"token deleted-sign deleted\">- {{>n-teaser/templates/heavy mods=(array 'small') widths=\"[160]\" }}\n</span><span class=\"token inserted-sign inserted\">+ {{{x package=\"x-teaser\" component=\"Teaser\" preset=\"SmallHeavy\"}}}</span></code></pre></div>\n<h3 id=\"6-image-lazy-loading-optional\"><a href=\"#6-image-lazy-loading-optional\" aria-label=\"6 image lazy loading optional permalink\" class=\"anchor\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. Image lazy loading (optional)</h3>\n<p>If you have implemented image lazy loading on your pages using <a href=\"https://github.com/Financial-Times/n-image\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">n-image</a> or <a href=\"https://github.com/Financial-Times/o-lazy-load/\" target=\"_blank\" rel=\"nofollow noopener noreferrer\">o-lazy-load</a> you can continue to use this functionality with x-teaser. Setting the <code class=\"language-text\">imageLazyload</code> property to <code class=\"language-text\">true</code> will instruct the component to render the image with a <code class=\"language-text\">data-src</code> property instead of a <code class=\"language-text\">src</code> property. If you need to set a specific class name to identify these images you can set the <code class=\"language-text\">imageLazyload</code> property to a string, which will be appended to list of image class names.</p>\n<div class=\"gatsby-highlight\" data-language=\"handlebars\"><pre class=\"language-handlebars\"><code class=\"language-handlebars\"><span class=\"token comment\">&lt;!-- if using o-lazy-load --></span>\n<span class=\"token handlebars language-handlebars\"><span class=\"token delimiter punctuation\">{{{</span><span class=\"token variable\">x</span> <span class=\"token variable\">package</span><span class=\"token punctuation\">=</span><span class=\"token string\">\"x-teaser\"</span> <span class=\"token variable\">component</span><span class=\"token punctuation\">=</span><span class=\"token string\">\"Teaser\"</span> <span class=\"token variable\">preset</span><span class=\"token punctuation\">=</span><span class=\"token string\">\"SmallHeavy\"</span> <span class=\"token variable\">imageLazyLoad</span><span class=\"token punctuation\">=</span><span class=\"token string\">\"o-lazy-load\"</span><span class=\"token delimiter punctuation\">}}}</span></span>\n\n<span class=\"token comment\">&lt;!-- if using n-image --></span>\n<span class=\"token handlebars language-handlebars\"><span class=\"token delimiter punctuation\">{{{</span><span class=\"token variable\">x</span> <span class=\"token variable\">package</span><span class=\"token punctuation\">=</span><span class=\"token string\">\"x-teaser\"</span> <span class=\"token variable\">component</span><span class=\"token punctuation\">=</span><span class=\"token string\">\"Teaser\"</span> <span class=\"token variable\">preset</span><span class=\"token punctuation\">=</span><span class=\"token string\">\"SmallHeavy\"</span> <span class=\"token variable\">imageLazyLoad</span><span class=\"token punctuation\">=</span><span class=\"token string\">\"n-image--lazy-loading\"</span><span class=\"token delimiter punctuation\">}}}</span></span></code></pre></div>","headings":[{"value":"Migrating from n-teaser to x-teaser","depth":1},{"value":"Major differences","depth":2},{"value":"Guide","depth":2},{"value":"1. Install dependencies","depth":3},{"value":"2. Install and configure a runtime","depth":3},{"value":"3. Load Handlebars helpers","depth":3},{"value":"4. Fetching the right data","depth":3},{"value":"Changes to GraphQL queries","depth":4},{"value":"Changes to Elasticsearch queries","depth":4},{"value":"5. Update template includes","depth":3},{"value":"6. Image lazy loading (optional)","depth":3}]},"menu":{"edges":[{"node":{"title":"Get started","items":[{"title":"What is x-dash?","link":"/docs/get-started/what-is-x-dash"},{"title":"Installation","link":"/docs/get-started/installation"},{"title":"Working with x-dash","link":"/docs/get-started/working-with-x-dash"}]}},{"node":{"title":"Components in-depth","items":[{"title":"Overview","link":"/docs/components/overview"},{"title":"Creating components","link":"/docs/components/creation"},{"title":"JavaScript","link":"/docs/components/javascript"},{"title":"Styling","link":"/docs/components/styling"},{"title":"Stories","link":"/docs/components/stories"},{"title":"Interactions","link":"/docs/components/interactions"},{"title":"Testing","link":"/docs/components/testing"}]}},{"node":{"title":"Integrating x-dash","items":[{"title":"Using components","link":"/docs/integration/using-components"},{"title":"Local development","link":"/docs/integration/local-development"}]}},{"node":{"title":"Guides","items":[{"title":"Migrating to x-teaser","link":"/docs/guides/migrating-to-x-teaser"}]}}]}},"pageContext":{"isCreatedByStatefulCreatePages":false,"type":"documentation-page","source":"docs","title":"Migrating from n-teaser to x-teaser"}}}